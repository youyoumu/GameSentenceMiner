import { env } from '#/env';
import { BrowserWindow } from 'electron';

type BrowserWindowOptions = ConstructorParameters<typeof BrowserWindow>[0];
export class AppWindow {
    options: BrowserWindowOptions;
    win: BrowserWindow | undefined;

    constructor(options: BrowserWindowOptions) {
        options = options ?? {};
        const overrideOptions: BrowserWindowOptions = {
            webPreferences: {
                preload: env.PRELOAD_PATH,
            },
        };
        Object.assign(options, overrideOptions);
        this.options = options;
    }

    create() {
        this.win = new BrowserWindow(this.options);

        this.win.on('closed', () => {
            this.win = undefined;
        });
    }

    open() {
        if (!this.win || this.win.isDestroyed()) {
            this.create();
        }
        this.win?.show();
    }
}
